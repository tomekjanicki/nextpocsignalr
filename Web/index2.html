<!DOCTYPE html>
<html>
<head>
    <title>POC Version 2</title>
    <meta charset="utf-8" />
    <link href="MyContent/index2.css" rel="stylesheet" />
</head>
<body>
    <div data-bind="visible: loginVisible">
        User name:
        <input type="text" data-bind="value: userName" />
        Password:
        <input type="text" data-bind="value: password" />
        <br />
        <input type="button" value="Login" data-bind="click: login" />
    </div>
    <div data-bind="visible: logoutVisible" style="display: none">
        Logged as <span data-bind="text: userName"></span>
        <input type="button" value="Logout" data-bind="click: logout" />
    </div>
    <div data-bind="visible: pagesVisible" style="display: none">
        Pages:
        <div data-bind="foreach: pages">
            <input type="button" data-bind="value: id, click: $parent.showPage" />
            <br />
        </div>
        <br />
        Saved pages:
        <div data-bind="foreach: pages">
            <input type="button" data-bind="value: id, click: $parent.showSavedPage" />
            <br />
        </div>
    </div>
    <div data-bind="visible: squaresVisible" style="display: none">
        Squares
        <br />
        Chosen page <span data-bind="text: chosenPageId"></span>
        <input type="button" value="Back to pages" data-bind="click: backToPages" />
        <input type="button" value="Add square" data-bind="click: addSquare" />
        <input type="button" value="Save" data-bind="click: savePage" />
        <br />
        <br />
        <br />
        <div data-bind="foreach: squares" class="container">
            <div class="square" data-bind="style: { left: leftPx, top: topPx }, event: { dblclick: $parent.deleteSquare }, draggable: $parent.moveSquare"></div>
        </div>
    </div>
    <div data-bind="visible: savedSquaresVisible" style="display: none">
        Saved squares
        <br />
        Chosen page <span data-bind="text: chosenPageId"></span>
        <input type="button" value="Back to pages" data-bind="click: backToPages" />
        <br />
        <br />
        <br />
        <div data-bind="foreach: squares" class="container">
            <div class="square" data-bind="style: { left: leftPx, top: topPx }"></div>
        </div>
    </div>
    <form enctype="multipart/form-data">
        <input name="file" type="file" />
        <input type="button" value="Upload" id="abc" />
    </form>
    <script src="Scripts/knockout-3.4.2.js"></script>
    <script src="Scripts/jquery-3.1.1.min.js"></script>
    <script src="Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
    <script src="wcfproxy/signalr/hubs"></script>
    <script src="MyContent/index2.js"></script>
    <script type="text/javascript" language="javascript">
        $(function () {
            $('#abc').on('click', function () {
                $.ajax({
                    url: '/wcfproxy/ServiceProxy.svc/PutPageFile',
                    type: 'POST',
                    data: new FormData($("form")[0]),
                    // Tell jQuery not to process data or worry about content-type
                    // You *must* include these options!
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function() {
                  alert("ok");  
                }).fail(function() {
                    alert("fail");
                });
            });
        });
    </script>
</body>
</html>
